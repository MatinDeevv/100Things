<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Your Certificate</title>

    <!-- Google Fonts for Elegant Typography -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto&display=swap"
      rel="stylesheet"
    />

    <!-- html2canvas & jsPDF Libraries -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
      integrity="sha512-BGaPnjOLsLLpo0z1GOiF595WzNcLOMVROFxHBWG02Mb1jkurLslQAYD3bX829dFXTXNvs6W0EOmRHQSnr4RsxQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"
      integrity="sha512-lz83dA8RZEr6NZyi/ViZGHp9STuANnTL1U7eLTlvNXxQi5jYKrDyXwFfqnWV41fEzNpmzBgmwTCW8QavL4T91A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <style>
      /* GLOBAL STYLES */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: "Roboto", sans-serif;
        background: #f0f0f0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 1em;
      }

      /* CERTIFICATE WRAPPER */
      .wrapper {
        background: #fff;
        width: 100%;
        max-width: 800px;
        padding: 2em;
        border: 15px solid #4b79a1;
        border-radius: 15px;
        position: relative;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        background-image: linear-gradient(
          135deg,
          #fff 25%,
          #f8f8f8 25%,
          #f8f8f8 50%,
          #fff 50%,
          #fff 75%,
          #f8f8f8 75%,
          #f8f8f8 100%
        );
        background-size: 28.28px 28.28px; /* 20px square rotated by 45 degrees */
      }

      /* Decorative Seal */
      .seal {
        position: absolute;
        top: -40px;
        right: -40px;
        width: 100px;
        height: 100px;
        background: url("https://i.imgur.com/4AiXzf8.png") no-repeat center
          center;
        background-size: contain;
        /* Placeholder seal image, replace with your own */
      }

      /* Certificate Title */
      .wrapper h1 {
        font-family: "Playfair Display", serif;
        font-size: 2.5em;
        color: #4b79a1;
        text-align: center;
        margin-bottom: 0.5em;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
      }

      /* Subtitle */
      .wrapper h2 {
        font-family: "Roboto", sans-serif;
        font-size: 1.5em;
        color: #333;
        text-align: center;
        margin-bottom: 1.5em;
      }

      /* Certificate Body */
      .certificate-content {
        text-align: center;
        padding: 0 2em;
      }
      .certificate-content p {
        font-size: 1.1em;
        color: #555;
        margin-bottom: 1em;
        line-height: 1.6em;
      }
      .certificate-content .cert-name {
        font-family: "Playfair Display", serif;
        font-size: 1.8em;
        color: #4b79a1;
        margin: 1em 0;
        text-transform: uppercase;
      }
      .certificate-content .cert-score {
        font-size: 1.3em;
        color: #333;
        margin-bottom: 1.5em;
      }

      /* Signature Section */
      .signature {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 2em;
      }
      .signature img {
        width: 100px;
        height: auto;
        margin-left: 2em;
        /* Placeholder signature image, replace with your own */
        background: url("https://i.imgur.com/7yUvePI.png") no-repeat center
          center;
        background-size: contain;
      }
      .signature-text {
        text-align: center;
      }
      .signature-text p {
        font-size: 1em;
        color: #555;
      }

      /* Download Button */
      .download-container {
        text-align: center;
        margin-top: 2em;
      }
      .download-btn {
        background: #4b79a1;
        color: #fff;
        border: none;
        padding: 0.8em 1.5em;
        font-size: 1em;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      }
      .download-btn:hover {
        background: #385c78;
      }

      /* Responsive Design */
      @media (max-width: 600px) {
        .wrapper {
          padding: 1.5em;
        }
        .wrapper h1 {
          font-size: 2em;
        }
        .wrapper h2 {
          font-size: 1.2em;
        }
        .certificate-content .cert-name {
          font-size: 1.5em;
        }
        .certificate-content .cert-score {
          font-size: 1.1em;
        }
        .signature img {
          width: 80px;
        }
        .download-btn {
          padding: 0.6em 1.2em;
          font-size: 0.9em;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrapper" id="certificateWrapper">
      <div class="seal"></div>
      <!-- Decorative Seal -->

      <h1>Certificate of Achievement</h1>
      <h2>This certificate is proudly presented to</h2>

      <div class="certificate-content">
        <p class="cert-name" id="certName">[Your Name]</p>
        <p class="cert-score" id="certScore">
          You have completed 0 out of 100 items!
        </p>
        <p>in the “100 Things To Do Before You Die” challenge.</p>
      </div>

      <div class="signature">
        <div class="signature-text">
          <p>_________________________</p>
          <p>Signature</p>
        </div>
        <img src="https://i.imgur.com/7yUvePI.png" alt="Signature" />
        <!-- Placeholder signature -->
      </div>

      <div class="download-container">
        <button
          class="download-btn"
          id="downloadBtn"
          onclick="downloadCertificate()"
        >
          Download as PDF
        </button>
      </div>
    </div>

    <!-- Modal for Entering Name -->
    <div class="modal" id="nameModal" style="display: none">
      <!-- Optional: Implement a modal if you prefer -->
    </div>

    <script>
      // Import jsPDF from the global namespace
      const { jsPDF } = window.jspdf;

      // 1) Grab the score from the query string
      const urlParams = new URLSearchParams(window.location.search);
      const finalScore = urlParams.get("score") || 0;

      // 2) Show the score in the certificate
      const scoreText = document.getElementById("certScore");
      scoreText.innerText = `You have completed ${finalScore} out of 100 items!`;

      // 3) Prompt for the user's name
      const userName = prompt(
        "Please enter your name to generate your certificate:",
        "Your Name"
      );
      if (userName && userName.trim() !== "") {
        const certName = document.getElementById("certName");
        certName.innerText = userName.trim();
      } else {
        // If no name entered, set a default
        document.getElementById("certName").innerText = "Valued Participant";
      }

      // 4) Download Certificate as PDF
      function downloadCertificate() {
        html2canvas(document.getElementById("certificateWrapper")).then(
          (canvas) => {
            const imgData = canvas.toDataURL("image/png");
            const pdf = new jsPDF({
              orientation: "landscape",
              unit: "pt",
              format: [canvas.width, canvas.height],
            });

            pdf.addImage(imgData, "PNG", 0, 0, canvas.width, canvas.height);
            pdf.save(
              `${document.getElementById("certName").innerText}_Certificate.pdf`
            );
          }
        );
      }
    </script>
  </body>
</html>
